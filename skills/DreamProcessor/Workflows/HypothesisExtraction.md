# HypothesisExtraction Workflow

**Workflow ID**: HypothesisExtraction
**Skill**: DreamProcessor
**Trigger**: "extract hypotheses", "track hypotheses", "hypothesis status"

---

## Purpose

Manage the lifecycle of hypotheses generated by dream processing. Extract new hypotheses from dream reports, track their evolution, gather evidence, and manage verification status.

---

## Input

- **Mode**: One of:
  - `extract` - Find new hypotheses in recent dreams
  - `status` - Report on all tracked hypotheses
  - `update` - Update specific hypothesis with evidence
  - `prune` - Archive stale hypotheses
- **Source**: `~/.claude/DREAMS/` and `~/.claude/skills/DreamProcessor/Data/HypothesisRegistry.yaml`

---

## Output

- **Primary**: Status report or updated registry
- **Side effects**: Updates to HypothesisRegistry.yaml

---

## Hypothesis Lifecycle

```
┌─────────┐    evidence    ┌──────────┐    high confidence    ┌───────────┐
│   NEW   │ ─────────────→ │ TRACKING │ ─────────────────────→ │ VALIDATED │
└─────────┘                └──────────┘                        └───────────┘
                                │
                                │ contradicting evidence
                                ▼
                           ┌──────────┐
                           │ REFUTED  │
                           └──────────┘
                                │
                                │ no updates 30+ days
                                ▼
                           ┌──────────┐
                           │  STALE   │
                           └──────────┘
```

---

## Mode: Extract

**Purpose**: Scan dream reports for new hypotheses not yet in registry.

**Steps**:
1. Read recent dream reports (last 7 days by default)
2. Parse for hypothesis markers (`Hypothesis:`, `### HYP-*`)
3. Compare against HypothesisRegistry.yaml
4. Add new hypotheses with status "new"
5. Return list of newly extracted hypotheses

**Agent delegation**:
```
Task({
  subagent_type: "general-purpose",
  description: "Extract hypotheses",
  prompt: "Scan these dream reports for hypotheses:\n\n[DREAM_REPORTS]\n\nExtract any statements framed as hypotheses. For each, identify:\n- Statement\n- Confidence level\n- Evidence needed for validation\n- Suggested verification method\n\nReturn in structured format."
})
```

---

## Mode: Status

**Purpose**: Report on all tracked hypotheses.

**Steps**:
1. Load HypothesisRegistry.yaml
2. Group by status (new, tracking, validated, refuted, stale)
3. Calculate statistics (total, confidence distribution, age distribution)
4. Identify hypotheses needing attention (new without evidence, close to stale)
5. Return formatted status report

**Output format**:
```
## Hypothesis Status Report

### Summary
- Total tracked: 15
- New (awaiting evidence): 3
- Actively tracking: 8
- Validated: 2
- Refuted: 1
- Stale: 1

### Attention Needed
- HYP-2026-01-30-001: New for 7 days, no evidence gathered
- HYP-2026-01-15-003: 25 days since update, approaching stale

### Confidence Distribution
- Low: 6 (40%)
- Medium: 7 (47%)
- High: 2 (13%)

### By Category
- Technical: 8
- Behavioral: 4
- Strategic: 3
```

---

## Mode: Update

**Purpose**: Update a specific hypothesis with new evidence.

**Input parameters**:
- `hypothesis_id`: The HYP-YYYY-MM-DD-NNN identifier
- `evidence`: New evidence (supporting or contradicting)
- `confidence_change`: Optional explicit change (strengthen/weaken/unchanged)

**Steps**:
1. Load hypothesis from registry
2. Append evidence to tracking record
3. Recalculate confidence based on evidence
4. Update lastUpdated timestamp
5. Check for status transitions (tracking → validated/refuted)
6. Write updated registry

**Agent delegation** (for confidence calculation):
```
Task({
  subagent_type: "general-purpose",
  description: "Evaluate evidence",
  prompt: "Evaluate this evidence for hypothesis [ID]:\n\nHypothesis: [STATEMENT]\nCurrent confidence: [LEVEL]\nNew evidence: [EVIDENCE]\n\nDetermine:\n1. Does this support or contradict the hypothesis?\n2. How strong is this evidence?\n3. Should confidence change? By how much?\n4. Has threshold been reached for validated/refuted?"
})
```

---

## Mode: Resolve

**Purpose**: Actively test hypotheses whose verification methods can be executed with currently available data. This is the missing step between "tracking" and "validated/refuted."

**Steps**:
1. Load HypothesisRegistry.yaml
2. Filter for hypotheses where:
   - Status is `tracking` or `new` with high confidence
   - verificationMethod specifies a concrete, executable test
   - Required data/evidence is available NOW (not "in 90 days")
3. For each resolvable hypothesis:
   a. Read the verificationMethod carefully
   b. Gather the required data (catch-log counts, session counts, dream report counts, file inventories, etc.)
   c. Execute the test against the gathered data
   d. Determine: validated, refuted, or insufficient evidence
   e. Record the resolution with reasoning
4. Update registry with results
5. Return resolution report

**What "resolvable" means**:
- The verificationMethod can be answered with data in MEMORY/, DREAMS/, catch-log, or session artifacts
- It does NOT require future events, external experiments, or Christauff's subjective judgment
- It has a clear pass/fail criterion, not "track for 90 days"

**Agent delegation**:
```
Task({
  subagent_type: "general-purpose",
  description: "Resolve hypotheses",
  prompt: "Attempt to resolve these hypotheses using available data:\n\n[HYPOTHESES_WITH_VERIFICATION_METHODS]\n\nFor each hypothesis:\n1. Read the verificationMethod\n2. Gather the required data from the specified sources\n3. Apply the test criterion\n4. Determine: VALIDATED (evidence meets threshold), REFUTED (evidence contradicts), or INSUFFICIENT (not enough data yet)\n5. Show your work: what data you found, how you applied the test, why the result\n\nBe honest — if the data doesn't clearly validate or refute, say INSUFFICIENT."
})
```

**Resolution criteria**:
- VALIDATED: Evidence meets the verificationMethod's pass criterion
- REFUTED: Evidence meets the verificationMethod's fail criterion
- INSUFFICIENT: Data exists but doesn't clearly pass or fail
- NOT_TESTABLE: Required data doesn't exist yet

**Output format**:
```
## Hypothesis Resolution Report

### Resolved
| ID | Statement | Result | Evidence |
|----|-----------|--------|----------|
| HYP-X | ... | VALIDATED | 4/5 sessions showed X |
| HYP-Y | ... | REFUTED | 0/10 sessions showed Y |

### Insufficient Evidence
| ID | Statement | Missing | Next Check |
|----|-----------|---------|------------|
| HYP-Z | ... | Only 3 of 10 required sessions | 2026-03-01 |

### Not Yet Testable
| ID | Reason |
|----|--------|
| HYP-W | Requires architecture migration |
```

---

## Mode: Prune

**Purpose**: Archive hypotheses that are stale or resolved.

**Steps**:
1. Identify hypotheses with no updates in 30+ days (stale)
2. Identify validated/refuted hypotheses older than 90 days
3. Move to ARCHIVE section of registry
4. Update statistics
5. Report on pruned hypotheses

**Scalability note**: This is critical for decades of operation. Without pruning, the registry would grow unbounded.

---

## Evidence Types

| Type | Description | Weight |
|------|-------------|--------|
| **Direct observation** | Saw the pattern occur | High |
| **Anecdotal** | Single instance | Low |
| **Repeated** | Pattern seen 3+ times | Medium |
| **Contradicting** | Evidence against | Negative |
| **External** | Research/literature confirms | Medium |
| **Experimental** | Deliberate test | High |

---

## Confidence Calculation

```
Base confidence: Starting level (low/medium/high)

Modifiers:
  +1 for each supporting evidence (capped at +3)
  -1 for each contradicting evidence
  -0.5 for each 30 days without update

Thresholds:
  < 2: low confidence
  2-4: medium confidence
  > 4: high confidence
  > 6: candidate for validation
  < 0: candidate for refutation
```

---

## Scalability Design

**For decades of operation:**

1. **Registry is append-only YAML**: Easy to grep, human-readable, survives tool changes
2. **Hypotheses have explicit IDs**: HYP-YYYY-MM-DD-NNN format survives time
3. **Archival after 90 days**: Validated/refuted/stale hypotheses move to archive section
4. **Index by year**: After 1000+ hypotheses, split into yearly files
5. **Compression ratio**: ~20 hypotheses/month → ~240/year → ~2400/decade
6. **Active set**: Typically <50 hypotheses actively tracking at any time

---

## Example Workflow

```bash
# Extract new hypotheses from recent dreams
bun run DreamProcessor.ts --workflow=HypothesisExtraction --mode=extract

# Check status of all hypotheses
bun run DreamProcessor.ts --workflow=HypothesisExtraction --mode=status

# Update specific hypothesis with evidence
bun run DreamProcessor.ts --workflow=HypothesisExtraction --mode=update \
  --id=HYP-2026-01-30-001 \
  --evidence="Observed reduced user anxiety with streaming progress"

# Resolve testable hypotheses against available data
bun run DreamProcessor.ts --workflow=HypothesisExtraction --mode=resolve

# Prune stale hypotheses (run monthly)
bun run DreamProcessor.ts --workflow=HypothesisExtraction --mode=prune
```
